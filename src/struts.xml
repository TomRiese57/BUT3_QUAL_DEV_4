<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
        "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <!-- ************************************************ -->
    <!-- * Fichier de configuration du Framework STRUTS * -->
    <!-- ************************************************ -->

    <constant name="struts.devMode" value="true" />

    <package name="com.iut.banque" namespace="/" extends="struts-default">

        <!-- ========================================= -->
        <!-- Route dynamique générique                  -->
        <!-- ========================================= -->
        <action name="*.*.*" class="com.iut.banque.{1}.{2}" method="{3}">
            <result name="SUCCESS">/JSP/{2}.jsp</result>
            <result name="SUCCESSMANAGER">/JSP/{2}-Manager.jsp</result>
            <result name="ERROR">/JSP/{2}-error.jsp</result>
            <result name="LISTCLIENTS">/JSP/ListClients.jsp</result>
            <result>/JSP/{2}.jsp</result>
            <result name="MULTI">Multiple.jsp</result>
            <result name="FAILED">Failed.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Retours tableau de bord                   -->
        <!-- ========================================= -->
        <action name="retourTableauDeBordClient" class="com.iut.banque.controller.Connect">
            <result>/JSP/Connect.jsp</result>
        </action>

        <action name="retourTableauDeBordManager" class="com.iut.banque.controller.Connect">
            <result>/JSP/Connect-Manager.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Login / Logout                            -->
        <!-- ========================================= -->
        <action name="logout" class="com.iut.banque.controller.Connect" method="logout">
            <result name="SUCCESS">/JSP/Index.jsp</result>
        </action>

        <action name="retourAccueil">
            <result>/JSP/Index.jsp</result>
        </action>

        <action name="redirectionLogin">
            <result>/JSP/Login.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Mot de passe oublié (ResetPasswordAction) -->
        <!-- ========================================= -->
        <action name="redirectionResetPassword"
                class="com.iut.banque.controller.ResetPasswordAction"
                method="showPage">
            <result name="success">/JSP/ResetPasswordAction.jsp</result>
        </action>

        <action name="resetPassword" class="com.iut.banque.controller.ResetPasswordAction">
            <result name="success">/JSP/ResetPasswordAction.jsp</result>
            <result name="input">/JSP/ResetPasswordAction.jsp</result>
            <result name="error">/JSP/ResetPasswordAction.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Changement de mot de passe volontaire     -->
        <!-- (ChangePasswordAction — utilisateur connecté) -->
        <!-- ========================================= -->

        <!-- Affiche la page de changement de mot de passe -->
        <action name="changePasswordPage"
                class="com.iut.banque.controller.ChangePasswordAction"
                method="showPage">
            <result name="success">/JSP/ChangePassword.jsp</result>
            <result name="error">/JSP/Connect.jsp</result>
        </action>

        <!-- Traite le formulaire de changement de mot de passe -->
        <action name="changePassword"
                class="com.iut.banque.controller.ChangePasswordAction">
            <result name="success">/JSP/ChangePassword.jsp</result>
            <result name="input">/JSP/ChangePassword.jsp</result>
            <result name="error">/JSP/ChangePassword.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Détail compte                             -->
        <!-- ========================================= -->
        <action name="urlDetail" class="com.iut.banque.controller.DetailCompte">
            <result name="success">/JSP/DetailCompte.jsp</result>
        </action>

        <action name="listeCompteManager" class="com.iut.banque.controller.ListeCompteManager">
            <result>/JSP/ListeCompteManager.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Suppression de compte et d'utilisateur   -->
        <!-- ========================================= -->
        <action name="deleteAccount" class="com.iut.banque.controller.ListeCompteManager"
                method="deleteAccount">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">urlResultatSuppression</param>
                <param name="compteInfo">%{compteInfo}</param>
                <param name="client">%{client.userId}</param>
                <param name="account">true</param>
            </result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">urlResultatSuppression</param>
                <param name="compte">%{compte}</param>
                <param name="client">%{client.userId}</param>
                <param name="errorMessage">TECHNICAL</param>
                <param name="account">true</param>
            </result>
            <result name="NONEMPTYACCOUNT" type="redirectAction">
                <param name="actionName">urlResultatSuppression</param>
                <param name="compte">%{compte}</param>
                <param name="client">%{client.userId}</param>
                <param name="errorMessage">NONEMPTYACCOUNT</param>
                <param name="account">true</param>
            </result>
        </action>

        <action name="deleteUser" class="com.iut.banque.controller.ListeCompteManager"
                method="deleteUser">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">urlResultatSuppression</param>
                <param name="userInfo">%{userInfo}</param>
                <param name="account">false</param>
            </result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">urlResultatSuppression</param>
                <param name="client">%{client.userId}</param>
                <param name="errorMessage">TECHNICAL</param>
                <param name="account">false</param>
            </result>
            <result name="NONEMPTYACCOUNT" type="redirectAction">
                <param name="actionName">urlResultatSuppression</param>
                <param name="client">%{client.userId}</param>
                <param name="errorMessage">NONEMPTYACCOUNT</param>
                <param name="account">false</param>
            </result>
        </action>

        <action name="urlResultatSuppression" class="com.iut.banque.controller.ResultatSuppression">
            <result>/JSP/ResultatSuppression.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Modification d'un compte par un manager  -->
        <!-- ========================================= -->
        <action name="editAccount" class="com.iut.banque.controller.DetailCompteEdit">
            <result name="SUCCESS">/JSP/DetailCompteEdit.jsp</result>
            <result>/JSP/DetailCompteEdit.jsp</result>
        </action>

        <action name="changerDecouvertAutoriseAction"
                class="com.iut.banque.controller.DetailCompteEdit"
                method="changementDecouvert">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
            </result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">TECHNICAL</param>
            </result>
            <result name="NEGATIVEOVERDRAFT" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">NEGATIVEOVERDRAFT</param>
            </result>
            <result name="INCOMPATIBLEOVERDRAFT" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">INCOMPATIBLEOVERDRAFT</param>
            </result>
        </action>

        <!-- ========================================= -->
        <!-- Création de compte                        -->
        <!-- ========================================= -->
        <action name="addAccount" class="com.iut.banque.controller.CreerCompte"
                method="creationCompte">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">urlAddAccount</param>
                <param name="client">%{client.userId}</param>
                <param name="error">false</param>
                <param name="result">true</param>
                <param name="compte">%{compte}</param>
                <param name="message">SUCCESS</param>
            </result>
            <result name="NONUNIQUEID" type="redirectAction">
                <param name="actionName">urlAddAccount</param>
                <param name="client">%{client.userId}</param>
                <param name="error">true</param>
                <param name="result">true</param>
                <param name="message">NONUNIQUEID</param>
            </result>
            <result name="INVALIDFORMAT" type="redirectAction">
                <param name="actionName">urlAddAccount</param>
                <param name="client">%{client.userId}</param>
                <param name="error">true</param>
                <param name="result">true</param>
                <param name="message">INVALIDFORMAT</param>
            </result>
        </action>

        <action name="urlAddAccount" class="com.iut.banque.controller.CreerCompte">
            <result>/JSP/CreerCompte.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Opérations sur les comptes               -->
        <!-- ========================================= -->
        <action name="creditAction" class="com.iut.banque.controller.DetailCompte"
                method="credit">
            <result name="SUCCESS">/JSP/DetailCompte.jsp</result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">urlDetail</param>
                <param name="compte">%{compte}</param>
                <param name="error">TECHNICAL</param>
            </result>
            <result name="NEGATIVEAMOUNT" type="redirectAction">
                <param name="actionName">urlDetail</param>
                <param name="compte">%{compte}</param>
                <param name="error">NEGATIVEAMOUNT</param>
            </result>
        </action>

        <action name="debitAction" class="com.iut.banque.controller.DetailCompte"
                method="debit">
            <result name="SUCCESS">/JSP/DetailCompte.jsp</result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">urlDetail</param>
                <param name="compte">%{compte}</param>
                <param name="error">TECHNICAL</param>
            </result>
            <result name="NOTENOUGHFUNDS" type="redirectAction">
                <param name="actionName">urlDetail</param>
                <param name="compte">%{compte}</param>
                <param name="error">BUSINESS</param>
            </result>
            <result name="NEGATIVEAMOUNT" type="redirectAction">
                <param name="actionName">urlDetail</param>
                <param name="compte">%{compte}</param>
                <param name="error">NEGATIVEAMOUNT</param>
            </result>
        </action>

        <action name="creditActionEdit" class="com.iut.banque.controller.DetailCompteEdit"
                method="credit">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
            </result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">TECHNICAL</param>
            </result>
            <result name="NEGATIVEAMOUNT" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">NEGATIVEAMOUNT</param>
            </result>
        </action>

        <action name="debitActionEdit" class="com.iut.banque.controller.DetailCompteEdit"
                method="debit">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
            </result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">TECHNICAL</param>
            </result>
            <result name="NOTENOUGHFUNDS" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">BUSINESS</param>
            </result>
            <result name="NEGATIVEAMOUNT" type="redirectAction">
                <param name="actionName">editAccount</param>
                <param name="compte">%{compte}</param>
                <param name="error">NEGATIVEAMOUNT</param>
            </result>
        </action>

        <!-- ========================================= -->
        <!-- Ajout d'un utilisateur                   -->
        <!-- ========================================= -->
        <action name="ajoutUtilisateur" class="com.iut.banque.controller.CreerUtilisateur"
                method="creationUtilisateur">
            <result name="SUCCESS" type="redirectAction">
                <param name="actionName">urlAjoutUtilisateur</param>
                <param name="result">SUCCESS</param>
                <param name="message">%{message}</param>
            </result>
            <result name="ERROR" type="redirectAction">
                <param name="actionName">urlAjoutUtilisateur</param>
                <param name="result">ERROR</param>
                <param name="message">%{message}</param>
            </result>
            <result type="redirectAction">
                <param name="actionName">urlAjoutUtilisateur</param>
                <param name="result">VANILLA</param>
            </result>
        </action>

        <action name="urlAjoutUtilisateur" class="com.iut.banque.controller.CreerUtilisateur">
            <result>/JSP/CreerUtilisateur.jsp</result>
        </action>

        <!-- ========================================= -->
        <!-- Gestion des cartes bancaires             -->
        <!-- ========================================= -->
        <action name="mesCartes" class="com.iut.banque.controller.CarteAction"
                method="listerCartes">
            <result name="success">/JSP/GestionCartes.jsp</result>
            <result name="error">/JSP/Connect.jsp</result>
        </action>

        <action name="listerCartes" class="com.iut.banque.controller.CarteAction"
                method="listerCartes">
            <result name="success">/JSP/GestionCartes.jsp</result>
            <result name="error">/JSP/Connect-Manager.jsp</result>
        </action>

        <action name="carteCreer" class="com.iut.banque.controller.CarteAction"
                method="creerCarte">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="input"   type="redirectAction">mesCartes</result>
            <result name="error"   type="redirectAction">mesCartes</result>
        </action>

        <action name="creerCarte" class="com.iut.banque.controller.CarteAction"
                method="creerCarte">
            <result name="success" type="redirectAction">
                <param name="actionName">listerCartes</param>
            </result>
            <result name="input">/JSP/GestionCartes.jsp</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="supprimerCarte" class="com.iut.banque.controller.CarteAction"
                method="supprimerCarte">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="carteBloquer" class="com.iut.banque.controller.CarteAction"
                method="bloquerCarte">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="error"   type="redirectAction">mesCartes</result>
        </action>

        <action name="bloquerCarte" class="com.iut.banque.controller.CarteAction"
                method="bloquerCarte">
            <result name="success" type="redirectAction">listerCartes</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="carteDebloquer" class="com.iut.banque.controller.CarteAction"
                method="debloquerCarte">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="error"   type="redirectAction">mesCartes</result>
        </action>

        <action name="debloquerCarte" class="com.iut.banque.controller.CarteAction"
                method="debloquerCarte">
            <result name="success" type="redirectAction">listerCartes</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="carteBasculerMode" class="com.iut.banque.controller.CarteAction"
                method="basculerMode">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="error"   type="redirectAction">mesCartes</result>
        </action>

        <action name="basculerModePaiement" class="com.iut.banque.controller.CarteAction"
                method="basculerModePaiement">
            <result name="success" type="redirectAction">listerCartes</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="carteModifierPlafondPaiement"
                class="com.iut.banque.controller.CarteAction"
                method="modifierPlafondPaiement">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="error"   type="redirectAction">mesCartes</result>
        </action>

        <action name="modifierPlafondPaiement" class="com.iut.banque.controller.CarteAction"
                method="modifierPlafondPaiement">
            <result name="success" type="redirectAction">listerCartes</result>
            <result name="input">/JSP/GestionCartes.jsp</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="carteModifierPlafondRetrait"
                class="com.iut.banque.controller.CarteAction"
                method="modifierPlafondRetrait">
            <result name="success" type="redirectAction">mesCartes</result>
            <result name="error"   type="redirectAction">mesCartes</result>
        </action>

        <action name="modifierPlafondRetrait" class="com.iut.banque.controller.CarteAction"
                method="modifierPlafondRetrait">
            <result name="success" type="redirectAction">listerCartes</result>
            <result name="input">/JSP/GestionCartes.jsp</result>
            <result name="error">/JSP/GestionCartes.jsp</result>
        </action>

        <action name="paiementCarte" class="com.iut.banque.controller.CarteAction"
                method="effectuerPaiement">
            <result name="success">/JSP/DetailCompte.jsp</result>
            <result name="input">/JSP/DetailCompte.jsp</result>
            <result name="error">/JSP/DetailCompte.jsp</result>
        </action>

        <action name="retraitCarte" class="com.iut.banque.controller.CarteAction"
                method="effectuerRetrait">
            <result name="success">/JSP/DetailCompte.jsp</result>
            <result name="input">/JSP/DetailCompte.jsp</result>
            <result name="error">/JSP/DetailCompte.jsp</result>
        </action>

    </package>
</struts>